#include <stdio.h>
#include <stdlib.h>

#define BUFFER_SIZE 128

int main() {
    // Nome do arquivo de entrada
    const char *arquivo_entrada = "lab2_ex2.txt";

    // Ponteiro para o arquivo
    FILE *arquivo;
    char buffer[BUFFER_SIZE + 1]; // +1 para o caractere nulo
    int count_linhas = 0;

    // Abrindo o arquivo de entrada no modo de leitura
    arquivo = fopen(arquivo_entrada, "r");
    if (arquivo == NULL) {
        perror("Não foi possível abrir o arquivo de entrada");
        return EXIT_FAILURE;
    }

    // Lendo o conteúdo do arquivo e contando as linhas
    size_t bytes_read;
    while ((bytes_read = fread(buffer, 1, BUFFER_SIZE, arquivo)) > 0) {
        buffer[bytes_read] = '\0'; // Adiciona o caractere nulo ao final

        // Contando o número de quebras de linha
        for (size_t i = 0; i < bytes_read; i++) {
            if (buffer[i] == '\n' || buffer[i] == '\r') { // Considera \r (carriage return) também
                count_linhas++;
            }
        }
    }

    // Se o arquivo não terminar com uma quebra de linha, adicionar uma linha final
    if (buffer[bytes_read - 1] != '\n' && bytes_read > 0) {
        count_linhas++;
    }

    // Fechando o arquivo
    fclose(arquivo);

    // Exibindo o número total de linhas
    printf("Número total de linhas: %d\n", count_linhas);

    return 0;
}
    // Exibindo o número total de linhas
    printf("Número total de linhas: %d\n", count_linhas);

    return 0;
}
